<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResourceMeter Component Demo - Runtime.zyjeski.com</title>
    
    <!-- ResourceMeter Component CSS -->
    <link rel="stylesheet" href="/css/components/resource-meter.css">
    
    <style>
        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --border: #404040;
            --accent: #2196F3;
            --success: #4CAF50;
            --warning: #FF9800;
            --error: #F44336;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .demo-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .demo-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .demo-header h1 {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .demo-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .demo-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 32px;
        }
        
        .demo-section h2 {
            color: var(--accent);
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .demo-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 24px;
            padding: 16px;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .demo-control-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
            min-width: 120px;
        }
        
        .demo-control-group label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        button, select, input[type="range"], input[type="number"] {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s ease;
        }
        
        button:hover {
            background: var(--accent);
            border-color: var(--accent);
            transform: translateY(-1px);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        input[type="range"] {
            padding: 4px;
        }
        
        input[type="number"] {
            width: 80px;
        }
        
        .meter-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }
        
        .meter-demo-item {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .meter-demo-item:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }
        
        .meter-demo-item h3 {
            margin: 0 0 16px 0;
            color: var(--text-primary);
            font-size: 1.1rem;
        }
        
        .meter-container {
            margin: 16px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .performance-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        
        .stat-item {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 12px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--success);
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .code-example {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
            overflow-x: auto;
        }
        
        .code-example pre {
            margin: 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            color: var(--text-primary);
        }
        
        .consciousness-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .consciousness-meter {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }
        
        .consciousness-meter h4 {
            margin: 0 0 12px 0;
            color: var(--text-primary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .consciousness-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 8px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .demo-controls {
                flex-direction: column;
            }
            
            .meter-showcase {
                grid-template-columns: 1fr;
            }
            
            .performance-stats {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .demo-container {
                padding: 10px;
            }
            
            .demo-section {
                padding: 16px;
            }
            
            .performance-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>ResourceMeter Component Demo</h1>
            <p>Canvas-based resource visualization for consciousness debugging. High-performance meters with smooth animations and threshold-based color coding.</p>
        </div>

        <!-- Basic Visualization Types -->
        <div class="demo-section">
            <h2>Visualization Types</h2>
            <div class="meter-showcase">
                <div class="meter-demo-item">
                    <h3>Circular Gauge</h3>
                    <div class="meter-container">
                        <div id="circular-demo" style="width: 180px; height: 180px;"></div>
                    </div>
                </div>
                
                <div class="meter-demo-item">
                    <h3>Linear Bar</h3>
                    <div class="meter-container">
                        <div id="linear-demo" style="width: 200px; height: 80px;"></div>
                    </div>
                </div>
                
                <div class="meter-demo-item">
                    <h3>Arc (Semicircle)</h3>
                    <div class="meter-container">
                        <div id="arc-demo" style="width: 180px; height: 100px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Controls -->
        <div class="demo-section">
            <h2>Interactive Controls</h2>
            <div class="demo-controls">
                <div class="demo-control-group">
                    <label>Value</label>
                    <input type="range" id="value-slider" min="0" max="100" value="65">
                    <input type="number" id="value-input" min="0" max="100" value="65">
                </div>
                
                <div class="demo-control-group">
                    <label>Type</label>
                    <select id="type-select">
                        <option value="circular">Circular</option>
                        <option value="linear">Linear</option>
                        <option value="arc">Arc</option>
                    </select>
                </div>
                
                <div class="demo-control-group">
                    <label>Metric</label>
                    <select id="metric-select">
                        <option value="cpu">CPU</option>
                        <option value="memory">Memory</option>
                        <option value="threads">Threads</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                
                <div class="demo-control-group">
                    <label>Animation</label>
                    <button id="animation-toggle">Enabled</button>
                </div>
                
                <div class="demo-control-group">
                    <label>Actions</label>
                    <button id="random-update">Random Update</button>
                </div>
            </div>
            
            <div class="meter-container">
                <div id="interactive-demo" style="width: 250px; height: 250px;"></div>
            </div>
        </div>

        <!-- Consciousness-as-Code Demo -->
        <div class="demo-section">
            <h2>Consciousness-as-Code Integration</h2>
            <p>ResourceMeter components visualizing mental processes as debuggable code:</p>

            <div class="consciousness-demo">
                <div class="consciousness-meter">
                    <h4>Mental Processing Load</h4>
                    <div id="consciousness-cpu" style="width: 150px; height: 150px; margin: 0 auto;"></div>
                    <div class="consciousness-description">High during complex decision-making</div>
                </div>

                <div class="consciousness-meter">
                    <h4>Emotional Weight Capacity</h4>
                    <div id="consciousness-memory" style="width: 150px; height: 150px; margin: 0 auto;"></div>
                    <div class="consciousness-description">Fills with unprocessed grief</div>
                </div>

                <div class="consciousness-meter">
                    <h4>Concurrent Thought Streams</h4>
                    <div id="consciousness-threads" style="width: 150px; height: 150px; margin: 0 auto;"></div>
                    <div class="consciousness-description">Multiple concerns running simultaneously</div>
                </div>

                <div class="consciousness-meter">
                    <h4>Grief Processing Bandwidth</h4>
                    <div id="consciousness-grief" style="width: 150px; height: 150px; margin: 0 auto;"></div>
                    <div class="consciousness-description">Custom metric for emotional processing</div>
                </div>
            </div>
        </div>

        <!-- Performance Demonstration -->
        <div class="demo-section">
            <h2>Performance Test</h2>
            <p>Testing smooth 60fps animations under rapid updates:</p>

            <div class="demo-controls">
                <div class="demo-control-group">
                    <label>Test Duration</label>
                    <select id="test-duration">
                        <option value="1000">1 second</option>
                        <option value="5000" selected>5 seconds</option>
                        <option value="10000">10 seconds</option>
                    </select>
                </div>

                <div class="demo-control-group">
                    <label>Update Frequency</label>
                    <select id="update-frequency">
                        <option value="16">60 FPS</option>
                        <option value="33" selected>30 FPS</option>
                        <option value="100">10 FPS</option>
                    </select>
                </div>

                <div class="demo-control-group">
                    <label>Actions</label>
                    <button id="start-performance-test">Start Test</button>
                    <button id="stop-performance-test" disabled>Stop Test</button>
                </div>
            </div>

            <div class="meter-container">
                <div id="performance-demo" style="width: 200px; height: 200px;"></div>
            </div>

            <div class="performance-stats">
                <div class="stat-item">
                    <div class="stat-value" id="updates-count">0</div>
                    <div class="stat-label">Updates</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="avg-fps">0</div>
                    <div class="stat-label">Avg FPS</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="frame-time">0ms</div>
                    <div class="stat-label">Frame Time</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="memory-usage">0MB</div>
                    <div class="stat-label">Memory Usage</div>
                </div>
            </div>
        </div>

        <!-- Code Examples -->
        <div class="demo-section">
            <h2>Usage Examples</h2>

            <h3>Basic Usage</h3>
            <div class="code-example">
                <pre><code>// Create a CPU meter
const cpuMeter = new ResourceMeter(document.getElementById('cpu-container'), {
  type: 'circular',
  metric: 'cpu',
  size: { width: 200, height: 200 }
});

// Update with CPU usage percentage
cpuMeter.update(75.5);</code></pre>
            </div>

            <h3>Custom Metric</h3>
            <div class="code-example">
                <pre><code>// Create a custom grief processing meter
const griefMeter = new ResourceMeter(document.getElementById('grief-container'), {
  type: 'arc',
  metric: 'custom',
  customUnit: 'units',
  max: 1000,
  thresholds: { low: 200, medium: 600, high: 800 },
  labelFormat: (value, metric) => `Grief Processing: ${value.toFixed(0)} units`
});

griefMeter.update(450);</code></pre>
            </div>

            <h3>WebSocket Integration</h3>
            <div class="code-example">
                <pre><code>// Update from consciousness data
socket.on('consciousness-update', (data) => {
  const cpuUsage = data.resources.cpu.percentage;
  const memoryUsed = data.resources.memory.used;
  const threadCount = data.resources.threads.active;

  cpuMeter.update(cpuUsage);
  memoryMeter.update(memoryUsed);
  threadMeter.update(threadCount);
});</code></pre>
            </div>
        </div>
    </div>

    <!-- ResourceMeter Component -->
    <script type="module">
        import ResourceMeter from '/js/components/ResourceMeter.js';

        // Demo state
        let circularDemo, linearDemo, arcDemo, interactiveDemo, performanceDemo;
        let consciousnessCpu, consciousnessMemory, consciousnessThreads, consciousnessGrief;
        let performanceTestInterval = null;
        let performanceStats = {
            updates: 0,
            startTime: 0,
            frameCount: 0,
            lastFrameTime: 0
        };

        // Initialize basic demos
        function initBasicDemos() {
            circularDemo = new ResourceMeter(document.getElementById('circular-demo'), {
                type: 'circular',
                metric: 'cpu'
            });

            linearDemo = new ResourceMeter(document.getElementById('linear-demo'), {
                type: 'linear',
                metric: 'memory'
            });

            arcDemo = new ResourceMeter(document.getElementById('arc-demo'), {
                type: 'arc',
                metric: 'threads'
            });

            // Set initial values
            circularDemo.update(65);
            linearDemo.update(45);
            arcDemo.update(80);
        }

        // Initialize interactive demo
        function initInteractiveDemo() {
            interactiveDemo = new ResourceMeter(document.getElementById('interactive-demo'), {
                type: 'circular',
                metric: 'cpu'
            });

            interactiveDemo.update(65);

            // Setup controls
            const valueSlider = document.getElementById('value-slider');
            const valueInput = document.getElementById('value-input');
            const typeSelect = document.getElementById('type-select');
            const metricSelect = document.getElementById('metric-select');
            const animationToggle = document.getElementById('animation-toggle');
            const randomUpdate = document.getElementById('random-update');

            // Value controls
            valueSlider.addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                valueInput.value = value;
                interactiveDemo.update(value);
            });

            valueInput.addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                valueSlider.value = value;
                interactiveDemo.update(value);
            });

            // Type control
            typeSelect.addEventListener('change', (e) => {
                interactiveDemo.setType(e.target.value);
            });

            // Metric control
            metricSelect.addEventListener('change', (e) => {
                interactiveDemo.options.metric = e.target.value;
                interactiveDemo.render();
            });

            // Animation toggle
            animationToggle.addEventListener('click', () => {
                interactiveDemo.options.animate = !interactiveDemo.options.animate;
                animationToggle.textContent = interactiveDemo.options.animate ? 'Enabled' : 'Disabled';
            });

            // Random update
            randomUpdate.addEventListener('click', () => {
                const randomValue = Math.floor(Math.random() * 101);
                valueSlider.value = randomValue;
                valueInput.value = randomValue;
                interactiveDemo.update(randomValue);
            });
        }

        // Initialize consciousness demo
        function initConsciousnessDemo() {
            consciousnessCpu = new ResourceMeter(document.getElementById('consciousness-cpu'), {
                type: 'circular',
                metric: 'cpu',
                labelFormat: (value) => `${value.toFixed(1)}% Load`
            });

            consciousnessMemory = new ResourceMeter(document.getElementById('consciousness-memory'), {
                type: 'circular',
                metric: 'memory',
                labelFormat: (value) => `${value.toFixed(1)}% Full`
            });

            consciousnessThreads = new ResourceMeter(document.getElementById('consciousness-threads'), {
                type: 'circular',
                metric: 'threads',
                max: 32,
                labelFormat: (value) => `${value.toFixed(0)} Streams`
            });

            consciousnessGrief = new ResourceMeter(document.getElementById('consciousness-grief'), {
                type: 'arc',
                metric: 'custom',
                max: 1000,
                customUnit: 'units',
                thresholds: { low: 200, medium: 600, high: 800 },
                labelFormat: (value) => `${value.toFixed(0)} units`
            });

            // Simulate consciousness data updates
            setInterval(() => {
                consciousnessCpu.update(30 + Math.random() * 40);
                consciousnessMemory.update(20 + Math.random() * 60);
                consciousnessThreads.update(5 + Math.random() * 15);
                consciousnessGrief.update(100 + Math.random() * 700);
            }, 2000);
        }

        // Initialize performance demo
        function initPerformanceDemo() {
            performanceDemo = new ResourceMeter(document.getElementById('performance-demo'), {
                type: 'circular',
                metric: 'cpu'
            });

            const startBtn = document.getElementById('start-performance-test');
            const stopBtn = document.getElementById('stop-performance-test');

            startBtn.addEventListener('click', startPerformanceTest);
            stopBtn.addEventListener('click', stopPerformanceTest);
        }

        function startPerformanceTest() {
            const duration = parseInt(document.getElementById('test-duration').value);
            const frequency = parseInt(document.getElementById('update-frequency').value);

            document.getElementById('start-performance-test').disabled = true;
            document.getElementById('stop-performance-test').disabled = false;

            performanceStats = {
                updates: 0,
                startTime: performance.now(),
                frameCount: 0,
                lastFrameTime: performance.now()
            };

            performanceTestInterval = setInterval(() => {
                const value = Math.random() * 100;
                performanceDemo.update(value);

                performanceStats.updates++;
                performanceStats.frameCount++;

                const now = performance.now();
                const frameTime = now - performanceStats.lastFrameTime;
                const elapsed = now - performanceStats.startTime;
                const avgFps = (performanceStats.frameCount / elapsed) * 1000;

                document.getElementById('updates-count').textContent = performanceStats.updates;
                document.getElementById('avg-fps').textContent = avgFps.toFixed(1);
                document.getElementById('frame-time').textContent = frameTime.toFixed(1) + 'ms';

                if (performance.memory) {
                    const memoryMB = (performance.memory.usedJSHeapSize / 1024 / 1024).toFixed(1);
                    document.getElementById('memory-usage').textContent = memoryMB + 'MB';
                }

                performanceStats.lastFrameTime = now;

                if (elapsed >= duration) {
                    stopPerformanceTest();
                }
            }, frequency);
        }

        function stopPerformanceTest() {
            if (performanceTestInterval) {
                clearInterval(performanceTestInterval);
                performanceTestInterval = null;
            }

            document.getElementById('start-performance-test').disabled = false;
            document.getElementById('stop-performance-test').disabled = true;
        }

        // Initialize all demos
        document.addEventListener('DOMContentLoaded', () => {
            initBasicDemos();
            initInteractiveDemo();
            initConsciousnessDemo();
            initPerformanceDemo();
        });
    </script>
</body>
</html>
